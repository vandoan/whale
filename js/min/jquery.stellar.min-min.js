!function(t,e,s,i){function o(e,s){this.element=e,this.options=t.extend({},r,s),this._defaults=r,this._name=n,this.init()}var n="stellar",r={scrollProperty:"scroll",positionProperty:"position",horizontalScrolling:!0,verticalScrolling:!0,horizontalOffset:0,verticalOffset:0,parallaxBackgrounds:!0,parallaxElements:!0,hideDistantElements:!0,viewportDetectionInterval:1e4,hideElement:function(t){t.hide()},showElement:function(t){t.show()}},a={scroll:{getTop:function(t){return t.scrollTop()},setTop:function(t,e){t.scrollTop(e)},getLeft:function(t){return t.scrollLeft()},setLeft:function(t,e){t.scrollLeft(e)}},position:{getTop:function(t){return-1*parseInt(t.css("top"),10)},setTop:function(t,e){t.css("top",e)},getLeft:function(t){return-1*parseInt(t.css("left"),10)},setLeft:function(t,e){t.css("left",e)}},margin:{getTop:function(t){return-1*parseInt(t.css("margin-top"),10)},setTop:function(t,e){t.css("margin-top",e)},getLeft:function(t){return-1*parseInt(t.css("margin-left"),10)},setLeft:function(t,e){t.css("margin-left",e)}},transform:{getTop:function(t){return"none"!==t.css(f+"transform")?-1*parseInt(t.css(f+"transform").match(/(-?[0-9]+)/g)[5],10):0},setTop:function(t,e){c(t,e,"Y")},getLeft:function(t){return"none"!==t.css(f+"transform")?-1*parseInt(t.css(f+"transform").match(/(-?[0-9]+)/g)[4],10):0},setLeft:function(t,e){c(t,e,"X")}}},l={position:{setTop:function(t,e){t.css("top",e)},setLeft:function(t,e){t.css("left",e)}},transform:{setTop:function(t,e,s){c(t,e-s,"Y")},setLeft:function(t,e,s){c(t,e-s,"X")}}},f=function(){var e="";return t.browser.webkit?e="-webkit-":t.browser.mozilla?e="-moz-":t.browser.opera?e="-o-":t.browser.msie&&(e="-ms-"),e}(),c=function(t,e,s){var i=t.css(f+"transform");"none"===i?t.css(f+"transform","translate"+s+"("+e+"px)"):t.css(f+"transform",p(i,/(-?[0-9]+[.]?[0-9]*)/g,"X"===s?5:6,e))},p=function(t,e,s,o){var n,r,a;return-1===t.search(e)?t:(n=t.split(e),a=2*s-1,n[a]===i?t:(n[a]=o,n.join("")))};o.prototype={init:function(){this.options.name=n+"_"+Math.floor(1e4*Math.random()),this._defineElements(),this._defineGetters(),this._defineSetters(),this.refresh(),this._startViewportDetectionLoop(),this._startAnimationLoop()},_defineElements:function(){this.element===s.body&&(this.element=e),this.$scrollElement=t(this.element),this.$element=this.element===e?t("body"):this.$scrollElement,this.$viewportElement=this.options.viewportElement!==i?t(this.options.viewportElement):this.$scrollElement[0]===e||0===this.options.scrollProperty.indexOf("scroll")?this.$scrollElement:this.$scrollElement.parent()},_defineGetters:function(){var t=this;this._getScrollLeft=function(){return a[t.options.scrollProperty].getLeft(t.$scrollElement)},this._getScrollTop=function(){return a[t.options.scrollProperty].getTop(t.$scrollElement)}},_defineSetters:function(){var t=this;this._setScrollLeft=function(e){a[t.options.scrollProperty].setLeft(t.$scrollElement,e)},this._setScrollTop=function(e){a[t.options.scrollProperty].setTop(t.$scrollElement,e)},this._setLeft=function(e,s,i){l[t.options.positionProperty].setLeft(e,s,i)},this._setTop=function(e,s,i){l[t.options.positionProperty].setTop(e,s,i)}},refresh:function(){var s=this,i=s._getScrollLeft(),o=s._getScrollTop();this._setScrollLeft(0),this._setScrollTop(0),this._setOffsets(),this._findParticles(),this._findBackgrounds(),navigator.userAgent.indexOf("WebKit")>0&&t(e).load(function(){var t=s._getScrollLeft(),e=s._getScrollTop();s._setScrollLeft(t+1),s._setScrollTop(e+1),s._setScrollLeft(t),s._setScrollTop(e)}),s._setScrollLeft(i),s._setScrollTop(o)},_findParticles:function(){var e=this,s=this._getScrollLeft(),o=this._getScrollTop();if(this.particles!==i)for(var n=this.particles.length-1;n>=0;n--)this.particles[n].$element.data("stellar-elementIsActive",i);this.particles=[],this.options.parallaxElements&&this.$element.find("[data-stellar-ratio]").each(function(s){var o=t(this),n,r,a,l,f,c,p,h,u,d=0,g=0,m=0,v=0;if(o.data("stellar-elementIsActive")){if(o.data("stellar-elementIsActive")!==this)return}else o.data("stellar-elementIsActive",this);e.options.showElement(o),o.data("stellar-startingLeft")?(o.css("left",o.data("stellar-startingLeft")),o.css("top",o.data("stellar-startingTop"))):(o.data("stellar-startingLeft",o.css("left")),o.data("stellar-startingTop",o.css("top"))),a=o.position().left,l=o.position().top,f="auto"===o.css("margin-left")?0:parseInt(o.css("margin-left"),10),c="auto"===o.css("margin-top")?0:parseInt(o.css("margin-top"),10),h=o.offset().left-f,u=o.offset().top-c,o.parents().each(function(){var e=t(this);return e.data("stellar-offset-parent")===!0?(d=m,g=v,p=e,!1):(m+=e.position().left,void(v+=e.position().top))}),n=o.data("stellar-horizontal-offset")!==i?o.data("stellar-horizontal-offset"):p!==i&&p.data("stellar-horizontal-offset")!==i?p.data("stellar-horizontal-offset"):e.horizontalOffset,r=o.data("stellar-vertical-offset")!==i?o.data("stellar-vertical-offset"):p!==i&&p.data("stellar-vertical-offset")!==i?p.data("stellar-vertical-offset"):e.verticalOffset,e.particles.push({$element:o,$offsetParent:p,isFixed:"fixed"===o.css("position"),horizontalOffset:n,verticalOffset:r,startingPositionLeft:a,startingPositionTop:l,startingOffsetLeft:h,startingOffsetTop:u,parentOffsetLeft:d,parentOffsetTop:g,stellarRatio:o.data("stellar-ratio")!==i?o.data("stellar-ratio"):1,width:o.outerWidth(!0),height:o.outerHeight(!0),isHidden:!1})})},_findBackgrounds:function(){var e=this,s=this._getScrollLeft(),o=this._getScrollTop(),n;this.backgrounds=[],this.options.parallaxBackgrounds&&(n=this.$element.find("[data-stellar-background-ratio]"),this.$element.is("[data-stellar-background-ratio]")&&n.add(this.$element),n.each(function(){var n=t(this),r=n.css("background-position").split(" "),a,l,f,c,p,h,u,d,g,m=0,v=0,L=0,T=0;if(n.data("stellar-backgroundIsActive")){if(n.data("stellar-backgroundIsActive")!==this)return}else n.data("stellar-backgroundIsActive",this);n.data("stellar-backgroundStartingLeft")?n.css("background-position",n.data("stellar-backgroundStartingLeft")+" "+n.data("stellar-backgroundStartingTop")):(n.data("stellar-backgroundStartingLeft",r[0]),n.data("stellar-backgroundStartingTop",r[1])),p="auto"===n.css("margin-left")?0:parseInt(n.css("margin-left"),10),h="auto"===n.css("margin-top")?0:parseInt(n.css("margin-top"),10),u=n.offset().left-p-s,d=n.offset().top-h-o,n.parents().each(function(){var e=t(this);return e.data("stellar-offset-parent")===!0?(m=L,v=T,g=e,!1):(L+=e.position().left,void(T+=e.position().top))}),a=n.data("stellar-horizontal-offset")!==i?n.data("stellar-horizontal-offset"):g!==i&&g.data("stellar-horizontal-offset")!==i?g.data("stellar-horizontal-offset"):e.horizontalOffset,l=n.data("stellar-vertical-offset")!==i?n.data("stellar-vertical-offset"):g!==i&&g.data("stellar-vertical-offset")!==i?g.data("stellar-vertical-offset"):e.verticalOffset,e.backgrounds.push({$element:n,$offsetParent:g,isFixed:"fixed"===n.css("background-attachment"),horizontalOffset:a,verticalOffset:l,startingValueLeft:r[0],startingValueTop:r[1],startingBackgroundPositionLeft:isNaN(parseInt(r[0],10))?0:parseInt(r[0],10),startingBackgroundPositionTop:isNaN(parseInt(r[1],10))?0:parseInt(r[1],10),startingPositionLeft:n.position().left,startingPositionTop:n.position().top,startingOffsetLeft:u,startingOffsetTop:d,parentOffsetLeft:m,parentOffsetTop:v,stellarRatio:n.data("stellar-background-ratio")===i?1:n.data("stellar-background-ratio")})}))},destroy:function(){var e,s,i,o,n;for(n=this.particles.length-1;n>=0;n--)e=this.particles[n],s=e.$element.data("stellar-startingLeft"),i=e.$element.data("stellar-startingTop"),this._setLeft(e.$element,s,s),this._setTop(e.$element,i,i),this.options.showElement(e.$element),e.$element.data("stellar-startingLeft",null).data("stellar-elementIsActive",null).data("stellar-backgroundIsActive",null);for(n=this.backgrounds.length-1;n>=0;n--)o=this.backgrounds[n],o.$element.css("background-position",o.startingValueLeft+" "+o.startingValueTop);this._animationLoop=t.noop,clearInterval(this._viewportDetectionInterval)},_setOffsets:function(){var s=this;t(e).unbind("resize.horizontal-"+this.name).unbind("resize.vertical-"+this.name),"function"==typeof this.options.horizontalOffset?(this.horizontalOffset=this.options.horizontalOffset(),t(e).bind("resize.horizontal-"+this.name,function(){s.horizontalOffset=s.options.horizontalOffset()})):this.horizontalOffset=this.options.horizontalOffset,"function"==typeof this.options.verticalOffset?(this.verticalOffset=this.options.verticalOffset(),t(e).bind("resize.vertical-"+this.name,function(){s.verticalOffset=s.options.verticalOffset()})):this.verticalOffset=this.options.verticalOffset},_repositionElements:function(){var t=this._getScrollLeft(),e=this._getScrollTop(),s,i,o,n,r,a,l,f=!0,c=!0,p,h,u,d,g;if(this.currentScrollLeft!==t||this.currentScrollTop!==e||this.currentWidth!==this.viewportWidth||this.currentHeight!==this.viewportHeight){for(this.currentScrollLeft=t,this.currentScrollTop=e,this.currentWidth=this.viewportWidth,this.currentHeight=this.viewportHeight,g=this.particles.length-1;g>=0;g--)o=this.particles[g],n=o.isFixed?1:0,this.options.horizontalScrolling&&(p=(t+o.horizontalOffset+this.viewportOffsetLeft+o.startingPositionLeft-o.startingOffsetLeft+o.parentOffsetLeft)*-(o.stellarRatio+n-1)+o.startingPositionLeft,u=p-o.startingPositionLeft+o.startingOffsetLeft),this.options.verticalScrolling&&(h=(e+o.verticalOffset+this.viewportOffsetTop+o.startingPositionTop-o.startingOffsetTop+o.parentOffsetTop)*-(o.stellarRatio+n-1)+o.startingPositionTop,d=h-o.startingPositionTop+o.startingOffsetTop),this.options.hideDistantElements&&(c=!this.options.horizontalScrolling||u+o.width>(o.isFixed?0:t)&&u<(o.isFixed?0:t)+this.viewportWidth+this.viewportOffsetLeft,f=!this.options.verticalScrolling||d+o.height>(o.isFixed?0:e)&&d<(o.isFixed?0:e)+this.viewportHeight+this.viewportOffsetTop),c&&f?(o.isHidden&&(this.options.showElement(o.$element),o.isHidden=!1),this.options.horizontalScrolling&&this._setLeft(o.$element,p,o.startingPositionLeft),this.options.verticalScrolling&&this._setTop(o.$element,h,o.startingPositionTop)):o.isHidden||(this.options.hideElement(o.$element),o.isHidden=!0);for(g=this.backgrounds.length-1;g>=0;g--)r=this.backgrounds[g],n=r.isFixed?0:1,a=this.options.horizontalScrolling?(t+r.horizontalOffset-this.viewportOffsetLeft-r.startingOffsetLeft+r.parentOffsetLeft-r.startingBackgroundPositionLeft)*(n-r.stellarRatio)+"px":r.startingValueLeft,l=this.options.verticalScrolling?(e+r.verticalOffset-this.viewportOffsetTop-r.startingOffsetTop+r.parentOffsetTop-r.startingBackgroundPositionTop)*(n-r.stellarRatio)+"px":r.startingValueTop,r.$element.css("background-position",a+" "+l)}},_startViewportDetectionLoop:function(){var t=this,e=function(){var e=t.$viewportElement.offset();t.viewportWidth=t.$viewportElement.width(),t.viewportHeight=t.$viewportElement.height(),t.viewportOffsetTop=null!==e?e.top:0,t.viewportOffsetLeft=null!==e?e.left:0};e(),this._viewportDetectionInterval=setInterval(e,this.options.viewportDetectionInterval)},_startAnimationLoop:function(){var t=this,s=function(){return e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t,s){e.setTimeout(t,1e3/60)}}();this._animationLoop=function(){s(t._animationLoop),t._repositionElements()},this._animationLoop()}},t.fn[n]=function(e){var s=arguments;return e===i||"object"==typeof e?this.each(function(){t.data(this,"plugin_"+n)||t.data(this,"plugin_"+n,new o(this,e))}):"string"==typeof e&&"_"!==e[0]&&"init"!==e?this.each(function(){var i=t.data(this,"plugin_"+n);i instanceof o&&"function"==typeof i[e]&&i[e].apply(i,Array.prototype.slice.call(s,1)),"destroy"===e&&t.data(this,"plugin_"+n,null)}):void 0},t[n]=function(s){var i=t(e);return i.stellar.apply(i,Array.prototype.slice.call(arguments,0))},t[n].scrollProperty=a,t[n].positionProperty=l,e.Stellar=o}(jQuery,window,document);