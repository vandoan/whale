!function($,t,e,o,n){var i=$(o),s="waypoint.reached",r=function(e,o){e.element.trigger(s,o),e.options.triggerOnce&&e.element[t]("destroy")},l=function(t,e){if(!e)return-1;for(var o=e.waypoints.length-1;o>=0&&e.waypoints[o].element[0]!==t[0];)o-=1;return o},f=[],c=function(t){$.extend(this,{element:$(t),oldScroll:0,waypoints:[],didScroll:!1,didResize:!1,doScroll:$.proxy(function(){var t=this.element.scrollTop(),o=t>this.oldScroll,n=this,i=$.grep(this.waypoints,function(e,i){return o?e.offset>n.oldScroll&&e.offset<=t:e.offset<=n.oldScroll&&e.offset>t}),s=i.length;this.oldScroll&&t||$[e]("refresh"),this.oldScroll=t,s&&(o||i.reverse(),$.each(i,function(t,e){(e.options.continuous||t===s-1)&&r(e,[o?"down":"up"])}))},this)}),$(t).bind("scroll.waypoints",$.proxy(function(){this.didScroll||(this.didScroll=!0,o.setTimeout($.proxy(function(){this.doScroll(),this.didScroll=!1},this),$[e].settings.scrollThrottle))},this)).bind("resize.waypoints",$.proxy(function(){this.didResize||(this.didResize=!0,o.setTimeout($.proxy(function(){$[e]("refresh"),this.didResize=!1},this),$[e].settings.resizeThrottle))},this)),i.load($.proxy(function(){this.doScroll()},this))},u=function(t){var e=null;return $.each(f,function(o,n){return n.element[0]===t?(e=n,!1):void 0}),e},h={init:function(o,n){return this.each(function(){var i=$.fn[t].defaults.context,r,h=$(this);n&&n.context&&(i=n.context),$.isWindow(i)||(i=h.closest(i)[0]),r=u(i),r||(r=new c(i),f.push(r));var p=l(h,r),a=0>p?$.fn[t].defaults:r.waypoints[p].options,d=$.extend({},a,n);d.offset="bottom-in-view"===d.offset?function(){var t=$.isWindow(i)?$[e]("viewportHeight"):$(i).height();return t-$(this).outerHeight()}:d.offset,0>p?r.waypoints.push({element:h,offset:null,options:d}):r.waypoints[p].options=d,o&&h.bind(s,o),n&&n.handler&&h.bind(s,n.handler)}),$[e]("refresh"),this},remove:function(){return this.each(function(t,e){var o=$(e);$.each(f,function(t,e){var n=l(o,e);n>=0&&(e.waypoints.splice(n,1),e.waypoints.length||(e.element.unbind("scroll.waypoints resize.waypoints"),f.splice(t,1)))})})},destroy:function(){return this.unbind(s)[t]("remove")}},p={refresh:function(){$.each(f,function(t,o){var n=$.isWindow(o.element[0]),i=n?0:o.element.offset().top,s=n?$[e]("viewportHeight"):o.element.height(),l=n?0:o.element.scrollTop();$.each(o.waypoints,function(t,e){if(e){var n=e.options.offset,f=e.offset;if("function"==typeof e.options.offset)n=e.options.offset.apply(e.element);else if("string"==typeof e.options.offset){var c=parseFloat(e.options.offset);n=e.options.offset.indexOf("%")?Math.ceil(s*(c/100)):c}e.offset=e.element.offset().top-i+l-n,e.options.onlyOnScroll||(null!==f&&o.oldScroll>f&&o.oldScroll<=e.offset?r(e,["up"]):null!==f&&o.oldScroll<f&&o.oldScroll>=e.offset?r(e,["down"]):!f&&o.element.scrollTop()>e.offset&&r(e,["down"]))}}),o.waypoints.sort(function(t,e){return t.offset-e.offset})})},viewportHeight:function(){return o.innerHeight?o.innerHeight:i.height()},aggregate:function(){var t=$();return $.each(f,function(e,o){$.each(o.waypoints,function(e,o){t=t.add(o.element)})}),t}};$.fn[t]=function(e){return h[e]?h[e].apply(this,Array.prototype.slice.call(arguments,1)):"function"!=typeof e&&e?"object"==typeof e?h.init.apply(this,[null,e]):void $.error("Method "+e+" does not exist on jQuery "+t):h.init.apply(this,arguments)},$.fn[t].defaults={continuous:!0,offset:0,triggerOnce:!1,context:o},$[e]=function(t){return p[t]?p[t].apply(this):p.aggregate()},$[e].settings={resizeThrottle:200,scrollThrottle:100},i.load(function(){$[e]("refresh")})}(jQuery,"waypoint","waypoints",window);